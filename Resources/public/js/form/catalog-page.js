define(["jquery","routing","ekyna-form","ekyna-ui"],function(a,b,c){"use strict";return a.fn.catalogPageWidget=function(){return this.each(function(){function d(){h&&(h.abort(),h=null);var d=f.val();g.loadingSpinner(),h=a.ajax({url:b.generate("ekyna_product_catalog_admin_page_slots_form",{template:d,name:e.attr("name")}),dataType:"xml"}),h.done(function(b){g.loadingSpinner("off").empty();var d=a(b).find("form");if(1===d.length){g.append(a(d.text()).children());var e=c.create(g);e.init()}})}var e=a(this),f=e.find("select.catalog-page-template"),g=e.find("div.catalog-page-slots"),h=null;if(console.log("Catalog page form",f.length,g.length),1!==f.length||1!==g.length)throw"Unexpected form composition";f.on("change",d),g.is(":empty")&&d()}),this},{init:function(a){a.catalogPageWidget()}}});