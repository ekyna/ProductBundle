define(["jquery","routing","ekyna-form","ekyna-spinner"],function(r,o,u){"use strict";return r.fn.attributesWidget=function(){return this.each(function(){var n,e=r(this),i=e.closest("form").find(e.data("set-field")),a=null;1===i.length&&(n=e.data("parent-name"),i.on("change",function(){a&&(a.abort(),a=null);var t=parseInt(i.val())||0;t<=0?e.empty():(e.loadingSpinner(),(a=r.ajax({url:o.generate("admin_ekyna_product_product_attributes_form",{attributeSetId:t}),dataType:"xml"})).done(function(t){e.loadingSpinner("off"),e.empty();t=r(t).find("form");1===t.length&&(e.append(r(t.text().replace(/FORM__NAME/g,n)).children()),u.create(e).init())}))}))}),this},{init:function(t){t.attributesWidget()}}});