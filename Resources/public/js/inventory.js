define(["jquery","routing","ekyna-product/templates","ekyna-modal"],function(a,b,c,d){function e(){for(var a=l.serializeArray(),b={},c=0;c<a.length;c++)b[a[c].name]=a[c].value;return b}function f(){g&&g.abort(),h.empty(),i.show(),j.hide(),g=a.ajax({url:b.generate("ekyna_product_inventory_admin_products"),method:"GET",dataType:"json",data:e()}).done(function(b){i.hide(),void 0===b.products||0===b.products.length?j.show():a.each(b.products,function(b,d){a(c["inventory_line.html.twig"].render(d)).appendTo(h)})})}var g,h=a("#inventory_list"),i=a("#inventory_wait"),j=a("#inventory_none"),k=a("#inventory_sort"),l=a('form[name="inventory"]'),m=!1;l.on("submit",function(a){return a.preventDefault(),a.stopPropagation(),f(),!1}),l.on("reset",function(){f()}),h.on("click","a.stock-units",function(c){if(c.preventDefault(),c.stopPropagation(),m)return!1;m=!0;var e=a(c.currentTarget).parents("tr").eq(0).data("id");if(!e)return console.log("Undefined product id."),!1;try{var f=new d;f.load({url:b.generate("ekyna_product_inventory_admin_stock_units",{productId:e}),method:"GET"}),a(f).on("ekyna.modal.response",function(){m=!1})}catch(c){console.log(c),m=!1}return!1}),h.on("click","a.resupply",function(c){if(c.preventDefault(),c.stopPropagation(),m)return!1;m=!0;var e=a(c.currentTarget).parents("tr").eq(0).data("id");if(!e)return console.log("Undefined product id."),!1;try{var g=new d;g.load({url:b.generate("ekyna_product_inventory_admin_resupply",{productId:e}),method:"GET"}),a(g).on("ekyna.modal.response",function(a){m=!1,"json"===a.contentType&&(a.preventDefault(),a.content.success&&f())})}catch(c){console.log(c),m=!1}return!1}),k.on("click","th.sort a",function(b){b.preventDefault(),b.stopPropagation();var c=a(b.currentTarget),d="none";return c.hasClass("none")?d="asc":c.hasClass("asc")&&(d="desc"),k.find("th.sort a").removeClass("asc desc").addClass("none"),"none"!==d?(c.removeClass("none").addClass(d),l.find('input[name="inventory_search[sortBy]"]').val(c.data("by")),l.find('input[name="inventory_search[sortDir]"]').val(d)):(l.find('input[name="inventory_search[sortBy]"]').val(null),l.find('input[name="inventory_search[sortDir]"]').val(null)),l.trigger("submit"),!1}),f()});