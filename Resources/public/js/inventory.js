define(["jquery","routing","ekyna-product/templates","ekyna-modal"],function(a,b,c,d){function e(){for(var a=m.serializeArray(),b={},c=0;c<a.length;c++)b[a[c].name]=a[c].value;return b}function f(){h&&h.abort(),i.empty(),j.show(),k.hide(),h=a.ajax({url:b.generate("ekyna_product_inventory_admin_products"),method:"GET",dataType:"json",data:e()}).done(function(b){j.hide(),void 0===b.products||0===b.products.length?k.show():a.each(b.products,function(b,d){a(c["inventory_line.html.twig"].render(d)).appendTo(i)})})}function g(c,e){if(c.preventDefault(),c.stopPropagation(),n)return!1;n=!0;var g=a(c.currentTarget).parents("tr").eq(0).data("id");if(!g)return console.log("Undefined product id."),!1;try{var h=new d;h.load({url:b.generate(e,{productId:g}),method:"GET"}),a(h).on("ekyna.modal.response",function(a){n=!1,"json"===a.contentType&&(a.preventDefault(),a.content.success&&f())})}catch(i){console.log(i),n=!1}return!1}var h,i=a("#inventory_list"),j=a("#inventory_wait"),k=a("#inventory_none"),l=a("#inventory_sort"),m=a('form[name="inventory"]'),n=!1;m.on("submit",function(a){return a.preventDefault(),a.stopPropagation(),f(),!1}),m.on("reset",function(){f()}),i.on("click","a.quick-edit",function(a){return g(a,"ekyna_product_inventory_admin_quick_edit")}),i.on("click","a.stock-units",function(a){return g(a,"ekyna_product_inventory_admin_stock_units")}),i.on("click","a.treatment",function(a){return g(a,"ekyna_product_inventory_admin_customer_orders")}),i.on("click","a.resupply",function(a){return g(a,"ekyna_product_inventory_admin_resupply")}),l.on("click","th.sort a",function(b){b.preventDefault(),b.stopPropagation();var c=a(b.currentTarget),d="none";return c.hasClass("none")?d="asc":c.hasClass("asc")&&(d="desc"),l.find("th.sort a").removeClass("asc desc").addClass("none"),"none"!==d?(c.removeClass("none").addClass(d),m.find('input[name="inventory_search[sortBy]"]').val(c.data("by")),m.find('input[name="inventory_search[sortDir]"]').val(d)):(m.find('input[name="inventory_search[sortBy]"]').val(null),m.find('input[name="inventory_search[sortDir]"]').val(null)),m.trigger("submit"),!1}),f()});