define(["jquery","gsap/TimelineLite"],function(p,g){var i=!1;function o(t){var t=t.find("> .wrap"),n=Math.floor(.045*t.width()),e=Math.floor(.055*t.width());n<12?(n=12,e=15):24<n&&(n=24,e=30),t.find(".slide-caption").css({fontSize:n+"px",lineHeight:e+"px"})}return{init:function(t){var n,e;t.each(function(){var a,d,f,u,s,r,t,h,n=p(this);d=.3,f=.15,s=0,r=!(u=6),t=(a=n).find(".slide"),h=new g({onComplete:function(){this.restart()}}),1e3<(u=a.find(".slides").data("duration"))?u/=1e3:u=4,t.each(function(t){var n=p(this),e=n.find(".slide-image"),i=n.find(".slide-caption"),o=n.find(".slide-button"),l=0,c=new g({data:{index:t},onStart:function(){n.show()},onComplete:function(){n.hide(),a.trigger("product-slide-complete")}});c.call(function(){s=this.data.index,r=!0},null,c,0),c.from(e,d,{left:40,right:-40,opacity:0},0),c.from(i,d,{left:-40,right:40,opacity:0},f),c.from(o,d,{scale:.5,opacity:0},.3),l+=.6,c.call(function(){r=!1},null,null,.6),l+=u,c.call(function(){r=!0},null,c,l),c.to(o,d,{scale:.5,opacity:0},l),c.to(i,d,{left:40,right:-40,opacity:0},l+f),c.to(e,d,{left:-40,right:40,opacity:0},l+.3),c.call(function(){r=!1},null,null,l+=.6),h.add(c).addLabel("start"+t,t*(1.2+u)).addLabel("end"+t,t*(1.2+u)+d+.3+u)}),a.on("click","a.prev-slide",function(){r||(h.seek("end"+s),--s<0&&(s=t.length-1),a.one("product-slide-complete",function(){h.seek("start"+s,!0)}))}),a.on("click","a.next-slide",function(){r||(h.seek("end"+s,!0),++s>t.length-1&&(s=0),a.one("product-slide-complete",function(){h.seek("start"+s,!0)}))}),h.seek(.6),o(n)}),0<t.length&&!i&&(n=null,e=function(){p(".product-slide").each(function(){o(p(this))})},p(window).on("resize",function(){n&&clearTimeout(n),n=setTimeout(e,300)}),i=!0)}}});