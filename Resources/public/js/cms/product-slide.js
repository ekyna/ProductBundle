define(["gsap/TimelineLite"],function(a){function b(a){var b=a.find("> .wrap"),c=Math.floor(.045*b.width()),d=Math.floor(.055*b.width());12>c?(c=12,d=15):24<c&&(c=24,d=30),b.find(".slide-caption").css({fontSize:c+"px",lineHeight:d+"px"})}function c(b){function c(){i||(k.seek("end"+h,!0),h++,h>j.length-1&&(h=0),b.one("product-slide-complete",function(){k.seek("start"+h,!0)}))}function d(){i||(k.seek("end"+h),h--,0>h&&(h=j.length-1),b.one("product-slide-complete",function(){k.seek("start"+h,!0)}))}var e=.3,f=.15,g=6,h=0,i=!1,j=b.find(".slide"),k=new a({onComplete:function(){this.restart()}});g=b.find(".slides").data("duration"),g>1e3?g/=1e3:g=4,j.each(function(c){var d=$(this),j=d.find(".slide-image"),l=d.find(".slide-caption"),m=d.find(".slide-button"),n=0,o=new a({data:{index:c},onStart:function(){d.show()},onComplete:function(){d.hide(),b.trigger("product-slide-complete")}});o.call(function(){h=this.data.index,i=!0},null,o,n),o.from(j,e,{left:40,right:-40,opacity:0},n),o.from(l,e,{left:-40,right:40,opacity:0},n+f),o.from(m,e,{scale:.5,opacity:0},n+2*f),n+=e+2*f,o.call(function(){i=!1},null,null,n),n+=g,o.call(function(){i=!0},null,o,n),o.to(m,e,{scale:.5,opacity:0},n),o.to(l,e,{left:40,right:-40,opacity:0},n+f),o.to(j,e,{left:-40,right:40,opacity:0},n+2*f),n+=e+2*f,o.call(function(){i=!1},null,null,n),k.add(o).addLabel("start"+c,c*(2*e+4*f+g)).addLabel("end"+c,c*(2*e+4*f+g)+e+2*f+g)}),b.on("click","a.prev-slide",d),b.on("click","a.next-slide",c),k.seek(e+2*f)}var d=!1;return{init:function(a){if(a.each(function(){var a=$(this);c(a),b(a)}),0<a.length&&!d){var e=null,f=function(){$(".product-slide").each(function(){b($(this))})};$(window).on("resize",function(){e&&clearTimeout(e),e=setTimeout(f,300)}),d=!0}}}});